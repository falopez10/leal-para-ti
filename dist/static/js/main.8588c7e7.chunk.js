(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{114:function(e,t,a){e.exports=a(223)},120:function(e,t,a){},122:function(e,t,a){},223:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(14),o=a.n(l),i=(a(120),a(30)),s=a(31),c=a(36),u=a(32),d=a(35),h=a(9),m=(a(122),a(233)),p=a(33),E=a(224),g=a(232),v=a(225),f=a(234),b=a(226),C=a(24),y=a.n(C),k=a(84),L=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={showLoginModal:!1,inpEmail:"",inpPassword:""},a.handleLoginNavClick=a.handleLoginNavClick.bind(Object(h.a)(Object(h.a)(a))),a.handleLoginClose=a.handleLoginClose.bind(Object(h.a)(Object(h.a)(a))),a.handleLogin=a.handleLogin.bind(Object(h.a)(Object(h.a)(a))),a.handleLogOutClick=a.handleLogOutClick.bind(Object(h.a)(Object(h.a)(a))),a.renderLogButton=a.renderLogButton.bind(Object(h.a)(Object(h.a)(a))),a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"handleLoginNavClick",value:function(){this.setState({showLoginModal:!0})}},{key:"handleLogOutClick",value:function(){this.props.setUser({},"",!1)}},{key:"handleLoginClose",value:function(){this.setState({showLoginModal:!1})}},{key:"handleLogin",value:function(e,t){var a=this,n=k.BASE_API_USER_URL+k.LOGIN_URL,r=JSON.stringify({email:this.state.inpEmail,password:this.state.inpPassword}),l=new Headers;l.append("Content-type","application/json"),fetch(n,{method:"POST",headers:l,body:r}).then(function(e){return e.json()}).catch(function(e){return y()("Error","Hubo un error en el sistema: "+e+". Por favor intenta de nuevo.","error")}).then(function(e){100===e.code?(y()({type:"success",title:"Bienvenido, "+e.user.firstName,showConfirmButton:!0,timer:2500}),a.props.setUser(e.user,e.token,!0),a.setState({showLoginModal:!1})):101===e.code?y()("Email no v\xe1lido","Tu email y contrase\xf1a no coinciden :(","error"):y()("Error","Hubo un error en el sistema. Por favor intenta de nuevo.","error")})}},{key:"showLoginModal",value:function(){var e=this;return r.a.createElement(m.a,{show:this.state.showLoginModal},r.a.createElement(m.a.Header,null,r.a.createElement(m.a.Title,null,"Ingresar a Leal")),r.a.createElement(m.a.Body,null,r.a.createElement("h3",null,"Ingresa tu correo y contrase\xf1a"),r.a.createElement("input",{type:"hidden",name:"_token",value:""}),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"control-label"},"E-Mail"),r.a.createElement("div",null,r.a.createElement("input",{type:"email",autoComplete:"on",className:"form-control input-lg",name:"email",onChange:function(t){return e.setState({inpEmail:t.target.value})}}))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"control-label"},"Contrase\xf1a"),r.a.createElement("div",null,r.a.createElement("input",{ref:function(t){return e.inputPassword=t},type:"password",className:"form-control input-lg",name:"password",onChange:function(t){return e.setState({inpPassword:t.target.value})}})))),r.a.createElement(m.a.Footer,null,r.a.createElement(p.a,{bsStyle:"primary",onClick:this.handleLogin},"Ingresar"),r.a.createElement(p.a,{bsStyle:"danger",onClick:this.handleLoginClose},"Cancelar")))}},{key:"renderLogButton",value:function(){return this.props.logged?r.a.createElement(E.a,{eventKey:1,onClick:this.handleLogOutClick}," Salir"):r.a.createElement(E.a,{eventKey:1,onClick:this.handleLoginNavClick}," Ingresar")}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(g.a,{className:"NavBar",fixedTop:!0,inverse:!0},r.a.createElement(g.a.Header,null,r.a.createElement(g.a.Brand,null,r.a.createElement("a",{href:"#home"},"Leal para ti")),r.a.createElement(g.a.Toggle,null)),r.a.createElement(g.a.Collapse,null,r.a.createElement(v.a,null,this.renderLogButton(),r.a.createElement(f.a,{eventKey:2,title:"Sobre Leal",id:"basic-nav-dropdown"},r.a.createElement(b.a,{eventKey:2.1,href:"https://www.puntosleal.com/"},"Puntos Leal"),r.a.createElement(b.a,{divider:!0}),r.a.createElement(b.a,{eventKey:2.2,href:"https://play.google.com/store/apps/details?id=com.kubo.leal&hl=es_419"},"Play Store"),r.a.createElement(b.a,{eventKey:2.2,href:"https://itunes.apple.com/co/app/leal/id1083234969?mt=8"},"App Store"))))),this.showLoginModal())}}]),t}(n.Component),O=a(63),j=a.n(O),w=a(227),S=a(221),D=a(228),N=a(229),M=a(230),T=a(231),B=a(222),Y=(a(191),a(82)),A=a.n(Y),I=a(74),P=a(84),U=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={transactions:[],showDetailModal:!1,currentTransaction:{},startDateValue:"",endDateValue:"",types:["earn","redeem"]},a.fetchTransactions=a.fetchTransactions.bind(Object(h.a)(Object(h.a)(a))),a.handleTransactionClick=a.handleTransactionClick.bind(Object(h.a)(Object(h.a)(a))),a.handleClose=a.handleClose.bind(Object(h.a)(Object(h.a)(a))),a.handleStartDateChange=a.handleStartDateChange.bind(Object(h.a)(Object(h.a)(a))),a.handleEndDateChange=a.handleEndDateChange.bind(Object(h.a)(Object(h.a)(a))),a.handleCheckBoxChange=a.handleCheckBoxChange.bind(Object(h.a)(Object(h.a)(a))),a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.fetchTransactions()}},{key:"fetchTransactions",value:function(){var e=this,t=new URL(P.BASE_API_USER_URL+P.TRANSACTIONS_URL),a="Bearer "+this.props.token,n=new Headers;n.append("Content-type","application/json"),n.append("Authorization",a);var r=I(this.state.startDateValue,"YYYY-MM-DD").format(),l=I(this.state.endDateValue,"YYYY-MM-DD").format();if(console.log("dates: ",r,l,"types: ",this.state.types),"Invalid date"!==r&&"Invalid date"!==l){var o={startDate:r,endDate:l};Object.keys(o).forEach(function(e){return t.searchParams.append(e,o[e])})}fetch(t,{method:"GET",headers:n}).then(function(e){return e.json()}).catch(function(e){y()({type:"error",title:"Hubo un error en el sistema",text:"Por favor intenta de nuevo"})}).then(function(t){console.log("response:",t);var a=t.data.filter(function(t){return e.state.types.includes(t.type)});"Invalid date"!==r&&"Invalid date"!==l&&y()({type:"success",title:"Se han consultado tus transacciones exitosamente",showConfirmButton:!1,timer:1500}),e.setState({transactions:a})})}},{key:"handleTransactionClick",value:function(e){this.setState({showDetailModal:!0,currentTransaction:e})}},{key:"handleClose",value:function(){this.setState({showDetailModal:!1})}},{key:"handleStartDateChange",value:function(e){this.setState({startDateValue:e})}},{key:"handleEndDateChange",value:function(e){this.setState({endDateValue:e})}},{key:"handleCheckBoxChange",value:function(e){this.setState({types:e})}},{key:"showTransactionDetail",value:function(){var e=this.state.currentTransaction,t=r.a.createElement("br",null);if(e)return"redeem"===e.type?t=r.a.createElement("div",null,r.a.createElement("h3",null,"El ",r.a.createElement(j.a,{format:"D MMM YYYY"},e.createdDate)," redimiste ",e.points," puntos. "),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("h4",null,"\xa1Gracias por preferirnos!")):"earn"===e.type&&(t=r.a.createElement("div",null,r.a.createElement("h3",null,"El ",r.a.createElement(j.a,{format:"D MMM YYYY"},e.createdDate)," ganaste ",e.points," puntos. "),r.a.createElement("h4",null,"Los ganaste tras una compra por un valor de $",e.value,"."),r.a.createElement("br",null),r.a.createElement("h4",null,"\xa1Gracias por preferirnos!"))),r.a.createElement(m.a,{show:this.state.showDetailModal},r.a.createElement(m.a.Header,null,r.a.createElement(m.a.Title,null,"Detalle de transaccion ",e.num," ")),r.a.createElement(m.a.Body,null,t),r.a.createElement(m.a.Footer,null,r.a.createElement(p.a,{bsStyle:"info",onClick:this.handleClose},"Cerrar")))}},{key:"renderTransactionsList",value:function(){var e=this;return 0===this.state.transactions.length?r.a.createElement("p",null," No tienes transacciones en Leal"):r.a.createElement(w.a,null,this.state.transactions.map(function(t,a){t.num=a+1;var n="ganados";return"redeem"===t.type&&(n="redimidos"),r.a.createElement(S.a,{key:t.num,onClick:function(){return e.handleTransactionClick(t)},header:r.a.createElement("h4",null,r.a.createElement(j.a,{format:"D MMM YYYY",withTitle:!0},t.createdDate))},r.a.createElement("b",null,t.points)," puntos ",n)}))}},{key:"renderFilters",value:function(){return r.a.createElement(D.a,null,r.a.createElement(N.a,{sm:3,md:3},r.a.createElement("h4",null,"Fecha inicial"),r.a.createElement(A.a,{ref:"start-datepicker",value:this.state.startDateValue,onChange:this.handleStartDateChange})),r.a.createElement(N.a,{sm:3,md:3},r.a.createElement("h4",null,"Fecha Final"),r.a.createElement(A.a,{ref:"end-datepicker",value:this.state.endDateValue,onChange:this.handleEndDateChange})),r.a.createElement(N.a,{sm:3,md:3},r.a.createElement("h4",null,"Tipo de transacci\xf3n"),r.a.createElement(M.a,null,r.a.createElement(T.a,{type:"checkbox",value:this.state.types,onChange:this.handleCheckBoxChange},r.a.createElement(B.a,{value:"redeem"},"Puntos redimidos"),r.a.createElement(B.a,{value:"earn"},"Puntos ganados   ")))),r.a.createElement("br",null),r.a.createElement(p.a,{sm:3,md:3,bsStyle:"primary",onClick:this.fetchTransactions},"Filtrar"))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h3",null,"\xa1Mira y filtra tus transacciones por fecha y tipo!"),this.renderFilters(),r.a.createElement("br",null),r.a.createElement("div",null,this.renderTransactionsList()),this.showTransactionDetail())}}]),t}(n.Component),_=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={logged:!1,token:"",user:{}},a.renderMainComp=a.renderMainComp.bind(Object(h.a)(Object(h.a)(a))),a.renderLoggedComp=a.renderLoggedComp.bind(Object(h.a)(Object(h.a)(a))),a.renderNotLoggedComp=a.renderNotLoggedComp.bind(Object(h.a)(Object(h.a)(a))),a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"setUser",value:function(e,t,a){this.setState({user:e,token:t,logged:a})}},{key:"renderLoggedComp",value:function(){var e=this.state.user;return r.a.createElement("div",null,r.a.createElement("div",{className:"App-header"},r.a.createElement("h1",null," "),r.a.createElement("h1",null,"Leal para ti"),r.a.createElement("h2",null," Bienvenido, ",e.firstName," ",e.lastName," ")),r.a.createElement(U,{className:"App-body",token:this.state.token,user:e}))}},{key:"renderNotLoggedComp",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"App-header"},r.a.createElement("h1",null," "),r.a.createElement("h1",null,"Leal para ti"),r.a.createElement("h2",null,"Bienvenido a Leal")),r.a.createElement("div",{className:"App-body"},r.a.createElement("br",null),r.a.createElement("h4",null,"Ingresa para observar el historial de tus transacciones en la plataforma")))}},{key:"renderMainComp",value:function(){return this.state.logged?this.renderLoggedComp():this.renderNotLoggedComp()}},{key:"render",value:function(){var e=this.renderMainComp();return r.a.createElement("div",{className:"App"},r.a.createElement(L,{logged:this.state.logged,setUser:this.setUser.bind(this)}),r.a.createElement("div",null,e))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(_,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},84:function(e){e.exports={BASE_API_USER_URL:"https://pruebatecnica.puntosleal.com/api/user/",LOGIN_URL:"login",TRANSACTIONS_URL:"my/transactions"}}},[[114,2,1]]]);
//# sourceMappingURL=main.8588c7e7.chunk.js.map